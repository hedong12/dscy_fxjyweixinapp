(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/orderLists/main"],{"0dcc":function(e,t,r){"use strict";r.r(t);var n=r("fcc2"),o=r.n(n);for(var i in n)"default"!==i&&function(e){r.d(t,e,(function(){return n[e]}))}(i);t["default"]=o.a},"6bb8":function(e,t,r){"use strict";var n,o=function(){var e=this,t=e.$createElement;e._self._c},i=[];r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return n}))},"87e8":function(e,t,r){"use strict";var n=r("dd28"),o=r.n(n);o.a},"9fc9":function(e,t,r){"use strict";(function(e){r("6cdc"),r("921b");n(r("66fd"));var t=n(r("ab0f"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,r("543d")["createPage"])},ab0f:function(e,t,r){"use strict";r.r(t);var n=r("6bb8"),o=r("0dcc");for(var i in o)"default"!==i&&function(e){r.d(t,e,(function(){return o[e]}))}(i);r("87e8");var s,a=r("f0c5"),d=Object(a["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);t["default"]=d.exports},dd28:function(e,t,r){},fcc2:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(r("a34a")),o=s(r("b775")),i=r("7c15");function s(e){return e&&e.__esModule?e:{default:e}}function a(e){return u(e)||c(e)||d()}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function c(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function u(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function l(e,t,r,n,o,i,s){try{var a=e[i](s),d=a.value}catch(c){return void r(c)}a.done?t(d):Promise.resolve(d).then(n,o)}function f(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function s(e){l(i,n,o,s,a,"next",e)}function a(e){l(i,n,o,s,a,"throw",e)}s(void 0)}))}}var h=function(){r.e("components/orderItem").then(function(){return resolve(r("018d"))}.bind(null,r)).catch(r.oe)},p=function(){r.e("components/orderItemRow").then(function(){return resolve(r("5e56"))}.bind(null,r)).catch(r.oe)},m=function(){r.e("components/dialogBox").then(function(){return resolve(r("be00"))}.bind(null,r)).catch(r.oe)},g=function(){r.e("components/noData").then(function(){return resolve(r("6a2b"))}.bind(null,r)).catch(r.oe)},w={name:"",components:{OrderItem:h,OrderItemRow:p,NoData:g,DialogBox:m},data:function(){return{productType:[{id:1,text:"活动"},{id:2,text:"商品"},{id:3,text:"课程"},{id:4,text:"兑换"}],productKey:"",order_type:0,cart_lists:[],page:1,loading:!1,isLoading:!1,isShowCancelOrderBox:!1,currentOrder:{},tipsTitle:"确定要撤销该订单吗？",currentOperationType:0}},onShow:function(){this.order_type=this.$root.$mp.query.status||1,this.page=1,this.cart_lists=[],this.inits()},mounted:function(){wx.setNavigationBarTitle({title:"订单"})},onPullDownRefresh:function(){var e=f(n.default.mark((function e(){return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.page=1,this.cart_lists=[],this.inits(),setTimeout((function(){wx.stopPullDownRefresh()}),1500);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{setProductKey:function(e){var t=e.id;this.productKey=this.productKey==t?"":t,this.reset(),this.inits()},showTips:function(e,t){1==t?this.tipsTitle="确定要撤销该订单吗？":4==t&&(this.tipsTitle="是否确认收货？"),this.currentOperationType=t,this.currentOrder=e,this.isShowCancelOrderBox=!0},cancelOrder:function(e){"save"==e&&(1==this.currentOperationType&&this.changeOrder("cancel",this.currentOrder.ordersId),4==this.currentOperationType&&this.changeOrder("getGood",this.currentOrder.ordersId)),this.isShowCancelOrderBox=!1},page_turn:function(e){wx.switchTab({url:"../"+e+"/main"})},invite:function(e){wx.navigateTo({url:"../assembleDetail/main?assembleId="+e})},inits:function(){var e=f(n.default.mark((function e(){var t,r;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.isLoading){e.next=2;break}return e.abrupt("return");case 2:return this.isLoading=!0,wx.showLoading(),console.log(this.productKey),e.next=7,(0,i.getOrderList)({orderState:this.order_type,pageNum:this.page,goodsOneTypeId:this.productKey});case 7:t=e.sent,this.isLoading=!1,this.page++,wx.hideLoading(),console.log(t,"-------------\x3e"),r=[],t.forEach((function(e){e.ordersModelList&&(e.ordersModelList.forEach((function(e){e.price/=100,e.price=e.price.toFixed(2)})),e.cardId=e.companyId,e.goodsId=e.ordersModelList[0].goodsId,e.goodsName=e.ordersModelList[0].goodsName,e.specId=e.ordersModelList[0].specId,e.num=e.allNum,e.specNum=e.ordersModelList[0].num,e.allNum=0,e.ordersModelList.forEach((function(t){e.allNum+=t.num})),e.shopcartModelList=e.ordersModelList,e.orderPrice/=100,e.allPrice=e.orderPrice,e.orderPrice=e.orderPrice.toFixed(2),e.payPrice/=100,e.price=e.orderPrice/e.num,e.payPrice=e.payPrice.toFixed(2),r.push(e))})),this.cart_lists=[].concat(a(this.cart_lists),r);case 15:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),submitOrder:function(e){var t=e.mp.detail.formId,r="/orders/doReminder",n={ordersId:e.mp.detail.value.deliverGood,formId:t};wx.showLoading();var i=this;o.default.POST(n,"",r).then((function(e){wx.hideLoading(),e&&(wx.showToast({title:"操作成功！",icon:"success",duration:1e3}),"oneMoreOrder"==type&&(i.order_type=1),setTimeout((function(){i.reset(),i.inits()}),800))})).catch((function(e){wx.hideLoading(),console.log(e)}))},order_type_tap:function(e){this.order_type=e,this.reset(),this.inits()},order_tap:function(e){wx.setStorageSync("orderState",this.order_type),this.reset(),wx.navigateTo({url:"../orderDetail/main?orderIds="+e+"&orderState="+this.order_type})},toPay:function(e,t){var r=this;o.default.ToPay({ordersId:e,addressId:this.cart_lists[t].addressId,orderinfoRequestList:[this.cart_lists[t]]},"/orders/goTwoPay").then((function(e){r.order_type=2,r.reset(),r.inits()})).catch((function(e){}))},changeOrder:function(e,t,r){var n=this;if(!this.loading){var i="",s={};switch(e){case"cancel":i="/orders/updateOrderState",s={ordersId:t,orderState:5};break;case"payNow":return this.reset(),void wx.navigateTo({url:"../orderConfirm/main?orderId="+t});case"deliverGood":i="/orders/doReminder",s={ordersId:t};break;case"getGood":i="/orders/updateOrderState",s={ordersId:t,orderState:4};break;case"cancelRefund":i="/orders/backRefundState",s={ordersId:t};break;case"oneMoreOrder":i="/orders/anotherOrder",s={ordersId:t};break}wx.showLoading();var a=this;this.loading=!0,o.default.POST(s,"",i).then((function(t){wx.hideLoading(),t&&(wx.showToast({title:"操作成功！",icon:"success",duration:1e3}),setTimeout((function(){"oneMoreOrder"==e&&(a.order_type=1),"getGood"==e&&(a.order_type=4),a.reset(),a.inits()}),800))})).catch((function(e){wx.hideLoading(),console.log(e),wx.showToast({title:e.message,duration:2e3,icon:"none"})})).catch((function(){n.loading=!1}))}},reset:function(){this.page=1,this.isLoading=!1,this.cart_lists=[]}},onReachBottom:function(){this.inits()}};t.default=w}},[["9fc9","common/runtime","common/vendor"]]]);