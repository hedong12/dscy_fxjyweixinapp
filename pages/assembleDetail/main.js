(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/assembleDetail/main"],{"37e3":function(e,t,o){"use strict";o.r(t);var s=o("6ee3"),n=o.n(s);for(var a in s)"default"!==a&&function(e){o.d(t,e,(function(){return s[e]}))}(a);t["default"]=n.a},"6e98":function(e,t,o){},"6ee3":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=r(o("a34a")),n=r(o("b775")),a=o("ee73"),i=o("7e00");function r(e){return e&&e.__esModule?e:{default:e}}function d(e,t,o,s,n,a,i){try{var r=e[a](i),d=r.value}catch(c){return void o(c)}r.done?t(d):Promise.resolve(d).then(s,n)}function c(e){return function(){var t=this,o=arguments;return new Promise((function(s,n){var a=e.apply(t,o);function i(e){d(a,s,n,i,r,"next",e)}function r(e){d(a,s,n,i,r,"throw",e)}i(void 0)}))}}var u=function(){o.e("components/shareOrSave").then(function(){return resolve(o("5998"))}.bind(null,o)).catch(o.oe)},l=function(){Promise.all([o.e("common/vendor"),o.e("components/productRecommend")]).then(function(){return resolve(o("0b13"))}.bind(null,o)).catch(o.oe)},m={components:{ShareOrSave:u,ProductRecommend:l},data:function(){return{assembleEndTime:0,showShareOrSave:!1,assembleId:"",assembleInfo:{},cutTime:0,isShare:!1,myUserId:wx.getStorageSync("userId")||-1,isShowPopup:!1,types:[],type_index_1:0,num:1,orderId:""}},onLoad:function(e){console.log("Hello WOrld",e),e&&e.assembleId&&(this.assembleId=e.assembleId)},onShow:function(){this.getInfo()},methods:{goTo:function(e){wx.navigateTo({url:"/pages/"+e})},buynow:function(){var e=c(s.default.mark((function e(){var t,o,n,a,r;return s.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return wx.showLoading({title:"Loading...",mask:!0}),t=this.assembleInfo,e.next=4,(0,i.openOrJoinAssemble)(t.goodsId,this.assembleId>0?this.assembleId:void 0);case 4:o=e.sent,wx.hideLoading(),n={sum:this.num,goodsId:t.goodsId,assembleId:o},a=this.types[this.type_index_1].selectId,r=JSON.parse(JSON.stringify(this.types[this.type_index_1].goodSpecModelList.find((function(e){return a===e.specId})))),r.goodsName=t.goodsName,r.num=n.sum,r.photoUrl=t.goodPhoto,r.cardId=wx.getStorageSync("CARDID"),r["assembleId"]=n.assembleId||"",r.specName=this.types[this.type_index_1].specName,r.price=(r.assemblePrice/100).toFixed(2),console.log(r.assemblePrice,r.num,r,"===========>"),r.allPrice=r.price*r.num,wx.setStorageSync("orderInfo",[{companyId:JSON.parse(wx.getStorageSync("CURRENT_COMPANY")).companyId,companyName:JSON.parse(wx.getStorageSync("CURRENT_COMPANY")).companyName,orderState:1,allNum:1,orderPrice:r.price*r.num,shopcartModelList:[r]}]),wx.navigateTo({url:"../orderConfirm/main"});case 20:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onClose:function(){this.isShowPopup=!1},setNum:function(e){this.num=e.detail},type_tap_1:function(e,t){this.type_index_1=t,this.type_tap(this.type_index_1,0,this.types[this.type_index_1].goodSpecModelList[0].specId)},type_tap:function(e,t,o){wx.showLoading(),this.types[e].selectId=o;var s=parseFloat((this.types[e].goodSpecModelList[t].assemblePrice/100).toFixed(2)),n=this.types[e].goodSpecModelList[t].specNum;this.$set(this.types[e],"price",s),this.$set(this.types[e],"specNum",n),this.goodsPrice=s,this.num=1,wx.hideLoading()},GeneratePoster:function(){wx.navigateTo({url:"/pages/showBill/main"}),this.showShareOrSave=!1},getInfo:function(){var e=this;wx.showLoading({title:"Loading...",mask:!0}),n.default.POST({assembleId:this.assembleId},"","/assembles/getGoodsAssembleInfo").then((function(t){wx.hideLoading(),t.goodPhoto=t.goodsPhotoUrl,t.price=t.goodsMinPrice,e.assembleInfo=t,t.goodSpecModelList.map((function(e){e.selectId=e.goodSpecModelList[0].specId,e.specNum=e.goodSpecModelList[0].specNum})),e.types=t.goodSpecModelList,e.cutTime=parseInt((t.endTime-(new Date).getTime())/1e3),e.assembleEndTime=e.cutTime,setTimeout((function(){e.assembleEndTime-=1}),1e3),e.myUserId=wx.getStorageSync("userId")||-1;var o=t.ordersModelList.find((function(t){return t.userId===wx.getStorageSync("userId")&&(e.orderId=t.ordersId),t.userId===e.myUserId}));t.ordersModelList.push({avatarUrl:"https://yyker-one-stand.oss-cn-beijing.aliyuncs.com/yimai_photos/user/assembledetail-whay.png"}),o&&1===t.state?e.isShare=!0:e.isShare=!1}))}},onShareAppMessage:function(e){var t=wx.getStorageSync("CARDID")+""+(new Date).getTime();(0,a.addShareRecord)(wx.getStorageSync("COMPANYID"),2,this.assembleId,t);var o="/pages/assembleDetail/main?assembleId=".concat(this.assembleId,"&goType=1&shareId=").concat(t,"&cardId=").concat(this.assembleInfo.cardId,"&companyId=").concat(this.assembleInfo.companyId);return console.log(o),{path:o,title:this.assembleInfo.goodsName+" - "+JSON.parse(wx.getStorageSync("CURRENT_COMPANY")).companyName,imageUrl:this.assembleInfo.goodsPhotoUrl}}};t.default=m},"8dc1":function(e,t,o){"use strict";o.r(t);var s=o("9cd4"),n=o("37e3");for(var a in n)"default"!==a&&function(e){o.d(t,e,(function(){return n[e]}))}(a);o("ddc4");var i,r=o("f0c5"),d=Object(r["a"])(n["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],i);t["default"]=d.exports},"8eb7":function(e,t,o){"use strict";(function(e){o("6cdc"),o("921b");s(o("66fd"));var t=s(o("8dc1"));function s(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("543d")["createPage"])},"9cd4":function(e,t,o){"use strict";var s,n=function(){var e=this,t=e.$createElement,o=(e._self._c,(e.assembleInfo.goodsMinPrice/100).toFixed(2));e._isMounted||(e.e0=function(t){e.isShowPopup=!0},e.e1=function(t){e.showShareOrSave=!1}),e.$mp.data=Object.assign({},{$root:{g0:o}})},a=[];o.d(t,"b",(function(){return n})),o.d(t,"c",(function(){return a})),o.d(t,"a",(function(){return s}))},ddc4:function(e,t,o){"use strict";var s=o("6e98"),n=o.n(s);n.a}},[["8eb7","common/runtime","common/vendor"]]]);