(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/cardCase/main"],{"2fba":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=c(n("a34a")),a=n("2f62"),i=c(n("b775")),r=c(n("ed08")),s=c(n("0f88"));n("ee73");function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(n,!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t,n,o,a,i,r){try{var s=e[i](r),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(o,a)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var i=e.apply(t,n);function r(e){l(i,o,a,r,s,"next",e)}function s(e){l(i,o,a,r,s,"throw",e)}r(void 0)}))}}var p=function(){n.e("components/BusinessCard").then(function(){return resolve(n("aa6e"))}.bind(null,n)).catch(n.oe)},g=function(){Promise.all([n.e("common/vendor"),n.e("components/MeCard")]).then(function(){return resolve(n("7101"))}.bind(null,n)).catch(n.oe)},m=function(){n.e("components/selectorOne").then(function(){return resolve(n("af06"))}.bind(null,n)).catch(n.oe)},w=function(){n.e("components/getPhoneNumber").then(function(){return resolve(n("07e5"))}.bind(null,n)).catch(n.oe)},v=function(){n.e("components/getPhoneNumberCard").then(function(){return resolve(n("85a0"))}.bind(null,n)).catch(n.oe)},y=function(){n.e("components/AppNotice").then(function(){return resolve(n("72ed"))}.bind(null,n)).catch(n.oe)},b=function(){Promise.all([n.e("common/vendor"),n.e("components/NavBarByUser")]).then(function(){return resolve(n("f655"))}.bind(null,n)).catch(n.oe)},S=function(){n.e("pages/cardCase/components/InsertCard").then(function(){return resolve(n("6829"))}.bind(null,n)).catch(n.oe)},C={name:"",components:{MeCard:g,BusinessCard:p,SelectorOne:m,GetPhoneNumber:w,getPhoneNumberCard:v,AppNotice:y,NavBarByUser:b,InsertCard:S},data:function(){return{searchkey:"",last_searchkey:"",isfocus:!1,mine_card:{},lists:[],hasCard:wx.getStorageSync("hasCard")||!1,isLogin:s.default.returnIsLogin()||!1,addInfo:!1,card_msg:{picchecked:"",username:"",tel:"",wx:"",company_wx:"",email:"",post:"",company:"",company_logo:""},phoneMsg:{phoneData:"",iv:""},operateID:0,operateShow:!1,operateTypes:[{name:"置顶",id:"top"}],cardId:0,isfresh:!1,page:1,isLoading:!1,nodata:!1,isShowLogin:!1,isShowNotice:!0,noticeList:[],avatarUrl:"",isShowLoginGuide:!1,scrollContentHeight:0,mainHeight:0}},onUnload:function(){this.isShowLogin=!1,this.isShowNotice=!0,this.noticeList=[]},onPullDownRefresh:function(){var e=f(o.default.mark((function e(){return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("下拉刷新onPullDownRefresh"),wx.showNavigationBarLoading(),this.page=1,this.card_msg={},this.searchkey="",this.lists=[],this.nodata=!1,this.isLoading=!1,this.getAllCard(),wx.stopPullDownRefresh(),setTimeout((function(){wx.hideNavigationBarLoading()}),300);case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onShow:function(){this.searchkey="",this.isfresh=!0,this.card_msg={},this.page=1,this.isLogin=s.default.returnIsLogin()||!1,this.hasCard=wx.getStorageSync("hasCard")||!1,this.avatarUrl=wx.getStorageSync("avatarUrl"),this.getAllCard()},onHide:function(){this.addInfo=!1},mounted:function(){var e=f(o.default.mark((function e(){var t,n;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.default.systemIfo();case 2:t=e.sent,n=getApp().globalData.navHeight,this.mainHeight=t.windowHeight,this.scrollContentHeight=t.windowHeight-n;case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:h({},(0,a.mapActions)(["setPhone"]),{needLogin:function(){this.isLogin=!1,this.isShowLoginGuide=!0},cancelLoginGuide:function(){this.isShowLoginGuide=!1},scrolltoupper:function(){this.page=1,this.searchkey="",this.nodata=!1,this.isLoading=!1,this.getAllCard()},scrolltolower:function(){this.getAllCard()},loginSuccess:function(e){this.isLogin=!0,this.hasCard=wx.getStorageSync("hasCard")||!1,this.avatarUrl=wx.getStorageSync("avatarUrl")||"",e&&"insert"===e?wx.navigateTo({url:"../editCard/main?type=add&goType=1"}):(this.page=1,this.getAllCard())},getNotice:function(){var e=this;i.default.POST({},"","/notice/selectEffectiveList").then((function(t){e.noticeList=t||[]}))},shareApp:function(e,t,n,o){this.onShareAppMessage(e,t,n,o)},createCard:function(){this.toCreatePage()},search_focus:function(){this.isfocus=!0},search_confirm:function(){this.searchkey!==this.last_searchkey&&(wx.showLoading(),this.page=1,this.card_msg={},this.lists=[],this.nodata=!1,this.isLoading=!1,this.getAllCard())},page_turn:function(e){this.addInfo=!1,wx.navigateTo({url:"../"+e+"/main"})},toIndex:function(e,t,n){wx.setStorageSync("COMPANYID",t),wx.setStorageSync("CARDID",n),wx.setStorageSync("refreshCard",!0),this.addInfo=!1,wx.switchTab({url:"../"+e+"/main?cardId="+n+"&companyId+"+t})},getPhoneNumber:function(e){this.phoneMsg.phoneData=e.encryptedData,this.phoneMsg.iv=e.iv},getAllCard:function(){var e=this,t=this;t.isLoading||(t.isLoading=!0,i.default.POST({name:this.searchkey,pageNum:t.page},"","/businessCard/seeDetail","1").then((function(n){if(e.last_searchkey=e.searchkey,n){var o,a=[];if(n.forEach((function(e,n){var o={picchecked:e.logo||"",username:e.name||"",tel:e.phone||"",wx:e.personalWx||"",company_wx:e.companyWx||"",email:e.email||"",post:e.position||"",company:e.companyName,company_logo:e.companyLogo,cardId:e.cardId,companyId:e.companyId,recordId:e.recordId,shareSpeech:e.shareSpeech||""};3===e.state&&(t.card_msg=o),o.createTime=r.default.getdate(e.createTime,"dateTime"),a.push(o)})),1===t.page)e.lists=a;else(o=e.lists).push.apply(o,a);t.page++,t.hasCard||(t.addInfo=!0)}setTimeout((function(){t.nodata=!0,t.isLoading=!1}),500),wx.hideLoading()})).catch((function(e){wx.hideLoading()})))},moreTap:function(e,t,n){this.operateID=e,this.cardId=t,this.operateTypes=[{name:"置顶",id:"top"}],this.operateShow=!0},choose_tap:function(e){var t=this;this.operateShow=!1,wx.showLoading();var n="",o=0;"top"===e?(n="/businessCard/isTop",o=this.cardId):(n="/businessCard/delSeeCard",o=this.cardId),i.default.POST({cardId:o},"",n).then((function(e){wx.hideLoading(),wx.showToast({title:"操作成功！",duration:2e3,icon:"none"}),t.page=1,t.card_msg={},t.searchkey="",t.lists=[],t.nodata=!1,t.isLoading=!1,t.getAllCard()})).catch((function(e){wx.hideLoading()}))}})};t.default=C},"5c31":function(e,t,n){"use strict";var o,a=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.isfocus=!1},e.e1=function(t){e.operateShow=!e.operateShow},e.e2=function(t){e.isShowNotice=!1})},i=[];n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}))},"7cfa":function(e,t,n){"use strict";var o=n("e57f"),a=n.n(o);a.a},"88cf":function(e,t,n){"use strict";n.r(t);var o=n("2fba"),a=n.n(o);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},a68b:function(e,t,n){"use strict";n.r(t);var o=n("5c31"),a=n("88cf");for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);n("7cfa");var r,s=n("f0c5"),c=Object(s["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],r);t["default"]=c.exports},e0f4:function(e,t,n){"use strict";(function(e){n("6cdc"),n("921b");o(n("66fd"));var t=o(n("a68b"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},e57f:function(e,t,n){}},[["e0f4","common/runtime","common/vendor"]]]);