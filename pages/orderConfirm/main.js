(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/orderConfirm/main"],{"2c15":function(e,t,r){"use strict";r.r(t);var o=r("4f55"),n=r("5f23");for(var a in n)"default"!==a&&function(e){r.d(t,e,(function(){return n[e]}))}(a);var d,i=r("f0c5"),s=Object(i["a"])(n["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],d);t["default"]=s.exports},"4f55":function(e,t,r){"use strict";var o,n=function(){var e=this,t=e.$createElement;e._self._c},a=[];r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return o}))},"5f23":function(e,t,r){"use strict";r.r(t);var o=r("a450"),n=r.n(o);for(var a in o)"default"!==a&&function(e){r.d(t,e,(function(){return o[e]}))}(a);t["default"]=n.a},"64d2":function(e,t,r){"use strict";(function(e){r("6cdc"),r("921b");o(r("66fd"));var t=o(r("2c15"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,r("543d")["createPage"])},a450:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(r("b775"));n(r("ed08"));function n(e){return e&&e.__esModule?e:{default:e}}var a=function(){r.e("components/addressItem").then(function(){return resolve(r("7fda"))}.bind(null,r)).catch(r.oe)},d=function(){r.e("components/orderItem").then(function(){return resolve(r("018d"))}.bind(null,r)).catch(r.oe)},i={name:"",components:{AddressItem:a,OrderItem:d},data:function(){return{remark:"",cart_lists:[],total_money:0,default_addr:{name:"",tel:"",address:""},orderId:0,isLoading:!1}},onShow:function(){this.getOrderAddr()},mounted:function(){wx.setNavigationBarTitle({title:"订单确认"});var e=this;this.total_money=0,e.orderId=this.$root.$mp.query.orderId||0,this.cart_lists=wx.getStorageSync("orderInfo"),this.cart_lists.map((function(t){e.total_money+=Number(t.orderPrice)})),e.total_money=e.total_money.toFixed(2)},methods:{getOrderAddr:function(){var e=this;o.default.POST({},"","/personal/getAddress").then((function(t){wx.hideLoading();var r=!0,o=!1,n=void 0;try{for(var a,d=t[Symbol.iterator]();!(r=(a=d.next()).done);r=!0){var i=a.value;if(1==i.isdefault){e.default_addr={name:i.receiveName,tel:i.receivePhone,address:i.locationAddress+i.detailedAddress,addressId:i.addressId};break}}}catch(s){o=!0,n=s}finally{try{r||null==d.return||d.return()}finally{if(o)throw n}}})).catch((function(e){wx.hideLoading()}))},getOrderDetail:function(){var e=this;o.default.POST({ordersIds:e.orderId},"","/orders/getOrderInfo").then((function(t){wx.hideLoading(),t&&(e.total_money=0,t.forEach((function(t,r){t.ordersModelList.forEach((function(e,t){e.price/=100,e.price=e.price.toFixed(2),e.allPrice/=100,e.allPrice=e.allPrice.toFixed(2)})),t.shopcartModelList=t.ordersModelList,t.orderPrice/=100,t.orderPrice=t.orderPrice.toFixed(2),e.total_money+=Number(t.orderPrice),e.total_money=e.total_money.toFixed(2)})),e.cart_lists=t),console.log(t)})).catch((function(e){wx.hideLoading()}))},toPay:function(){var e=this;if(!this.isLoading){var t=this;if(t.default_addr.addressId&&void 0!=t.default_addr.addressId){var r=JSON.parse(JSON.stringify(t.cart_lists));r.map((function(e){e.orderPrice=100*e.orderPrice,e.shopcartModelList.map((function(t){t.price=100*t.price,t.allPrice=100*t.allPrice,t.twoRoyalty=e.twoRoyalty,t.oneRoyalty=e.oneRoyalty}))})),this.isLoading=!0;var n="";r[0].shopcartModelList&&r[0].shopcartModelList.length>0&&(n=r[0].shopcartModelList[0].assembleId);var a={orderinfoRequestList:r[0].shopcartModelList,addressId:t.default_addr.addressId,assembleId:n,remark:t.remark},d=1,i=wx.getStorageSync("forwardId"),s={level:d,forwardId:i};i&&a.orderinfoRequestList.forEach((function(e){e=Object.assign(e,s)})),o.default.ToPay(a).then((function(e){console.log(e)})).catch((function(e){console.log(e),setTimeout((function(){wx.navigateTo({url:"../orderLists/main?status=1"})}))})).catch((function(){e.isLoading=!1}))}else wx.showToast({title:"请先添加地址！",icon:"none"})}}}};t.default=i}},[["64d2","common/runtime","common/vendor"]]]);