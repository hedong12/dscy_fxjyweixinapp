(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/Dynamic/main"],{1838:function(t,n,e){"use strict";e.r(n);var o=e("d8b7"),i=e.n(o);for(var s in o)"default"!==s&&function(t){e.d(n,t,(function(){return o[t]}))}(s);n["default"]=i.a},"27d6":function(t,n,e){"use strict";(function(t){e("6cdc"),e("921b");o(e("66fd"));var n=o(e("70b8"));function o(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,e("543d")["createPage"])},"3c0d":function(t,n,e){},"70b8":function(t,n,e){"use strict";e.r(n);var o=e("dcc3"),i=e("1838");for(var s in i)"default"!==s&&function(t){e.d(n,t,(function(){return i[t]}))}(s);e("9e68");var a,c=e("f0c5"),r=Object(c["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],a);n["default"]=r.exports},"9e68":function(t,n,e){"use strict";var o=e("3c0d"),i=e.n(o);i.a},d8b7:function(t,n,e){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=m(e("a34a")),i=e("2f62"),s=m(e("0f88")),a=m(e("b775")),c=m(e("ed08")),r=e("ee73"),u=e("5f87");function m(t){return t&&t.__esModule?t:{default:t}}function d(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,o)}return e}function h(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?d(e,!0).forEach((function(n){l(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):d(e).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function l(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function p(t){return y(t)||g(t)||f()}function f(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function g(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function y(t){if(Array.isArray(t)){for(var n=0,e=new Array(t.length);n<t.length;n++)e[n]=t[n];return e}}function _(t,n,e,o,i,s,a){try{var c=t[s](a),r=c.value}catch(u){return void e(u)}c.done?n(r):Promise.resolve(r).then(o,i)}function b(t){return function(){var n=this,e=arguments;return new Promise((function(o,i){var s=t.apply(n,e);function a(t){_(s,o,i,a,c,"next",t)}function c(t){_(s,o,i,a,c,"throw",t)}a(void 0)}))}}var w=function(){Promise.all([e.e("common/vendor"),e.e("components/dynamicItem")]).then(function(){return resolve(e("73e1"))}.bind(null,e)).catch(e.oe)},v=function(){Promise.all([e.e("common/vendor"),e.e("components/NavBarByUser")]).then(function(){return resolve(e("f655"))}.bind(null,e)).catch(e.oe)},I=function(){e.e("components/noData").then(function(){return resolve(e("6a2b"))}.bind(null,e)).catch(e.oe)},S=function(){e.e("components/swiper").then(function(){return resolve(e("91b0"))}.bind(null,e)).catch(e.oe)},C=function(){e.e("components/FloatButtons").then(function(){return resolve(e("590c"))}.bind(null,e)).catch(e.oe)},D=function(){Promise.all([e.e("common/vendor"),e.e("components/LoginIntercept")]).then(function(){return resolve(e("f887"))}.bind(null,e)).catch(e.oe)},x=function(){Promise.all([e.e("common/vendor"),e.e("components/getPhone")]).then(function(){return resolve(e("7a78"))}.bind(null,e)).catch(e.oe)},N="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1551961574244&di=8729881910dc1f229760af2da633dad5&imgtype=0&src=http%3A%2F%2Fimg5.duitang.com%2Fuploads%2Fitem%2F201401%2F22%2F20140122194030_JBjii.jpeg",A={name:"",components:{DynamicItem:w,NoData:I,SelfSwiper:S,NavBarByUser:v,FloatButtons:C,LoginIntercept:D,getUserPhone:x},data:function(){return{prevImg:[N,N,N],dynamic_operate_show:!1,dynamic_lists:[],emojiArray:[["üò†","üò©","üò≤","üòû","üòµ","üò∞","üòí","üòç","üò§","üòú","üòù","üòã","üòò","üòö","üò∑","üò≥","üòÉ","üòÖ","üòÜ","üòÅ","üòÇ","üòä","‚ò∫","üòÑ","üò¢","üò≠","üò®","üò£","üò°","üò°","üòñ","üòî"],["üò±","üò™","üòè","üòì","üò•","üò´","üòâ"]],emoji_show:!1,comment_focus:!1,comments:"",input_show:!1,add_comments_index:0,text_height:30,emojiChar:"‚ò∫-üòã-üòå-üòç-üòè-üòú-üòù-üòû-üòî-üò™-üò≠-üòÅ-üòÇ-üòÉ-üòÖ-üòÜ-üëø-üòí-üòì-üòî-üòè-üòñ-üòò-üòö-üòí-üò°-üò¢-üò£-üò§-üò¢-üò®-üò≥-üòµ-üò∑-üò∏-üòª-üòº-üòΩ-üòæ-üòø-üôä-üôã-üôè-‚úà-üöá-üöÉ-üöå-üçÑ-üçÖ-üçÜ-üçá-üçà-üçâ-üçë-üçí-üçì-üêî-üê∂-üê∑-üë¶-üëß-üë±-üë©-üë∞-üë®-üë≤-üë≥-üíÉ-üíÑ-üíÖ-üíÜ-üíá-üåπ-üíë-üíì-üíò-üö≤",emoji:["60a","60b","60c","60d","60f","61b","61d","61e","61f","62a","62c","62e","602","603","605","606","608","612","613","614","615","616","618","619","620","621","623","624","625","627","629","633","635","637","63a","63b","63c","63d","63e","63f","64a","64b","64f","681","68a","68b","68c","344","345","346","347","348","349","351","352","353","414","415","416","466","467","468","469","470","471","472","473","483","484","485","486","487","490","491","493","498","6b4"],emojis:[],keyboard_height:0,COMPANYID:0,CARDID:"0",company_msg:{admin_logo:"",company_logo:"",company_name:""},page:1,isLoading:!1,nodata:!1,replayComment:{},banners:["http://jewshop-one-stand-test.oss-cn-shenzhen.aliyuncs.com/product-index/20190418160834.png"],avatarUrl:"",isLogin:s.default.returnIsLogin()||!1,isShowTalk:!0,isShowLoginGuide:!0,targetAvatarUrl:"",scrollContentHeight:0,mainHeight:0}},onHide:function(){this.clearPage()},onTabItemTap:function(t){(0,u.authSubscribeMessage)(this.subscriptionNew)},onShow:function(){if(wx.getStorageSync("phone"))if(s.default.returnIsLogin()){var t=this,n=t.CARDID;t.COMPANYID=wx.getStorageSync("COMPANYID")||650,t.CARDID=wx.getStorageSync("CARDID")||1926,console.log("===========->"),n==t.CARDID&&t.CARDID||(this.page=1,t.getcompany(),t.inits(),this.getAd()),this.isLogin=s.default.returnIsLogin()||!1,this.avatarUrl=wx.getStorageSync("avatarUrl")||""}else wx.switchTab({url:"/pages/index/main"});else wx.switchTab({url:"/pages/index/main"})},onPageScroll:function(t){this.comment_focus=!1,this.input_show=!1},mounted:function(){var t=b(o.default.mark((function t(){var n,e;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c.default.systemIfo();case 2:n=t.sent,e=getApp().globalData.navHeight,this.mainHeight=n.windowHeight,this.scrollContentHeight=n.windowHeight-e;case 6:case"end":return t.stop()}}),t,this)})));function n(){return t.apply(this,arguments)}return n}(),methods:{authSubscribeComment:function(){(0,u.authSubscribeComment)(this.subscriptionNew)},scrolltoupper:function(t){wx.showLoading({title:"Ëé∑ÂèñÊúÄÊñ∞Êï∞ÊçÆ‰∏≠"}),this.page=1,this.dynamic_lists=[],this.nodata=!1,this.isLoading=!1,this.inits(),this.getAd()},scrolltolower:function(t){this.inits()},cancelLoginGuide:function(){this.isShowLoginGuide=!1},loginGuide:function(){this.isShowLoginGuide=!0},talk:function(){(0,u.authSubscribeMessage)(this.subscriptionNew),wx.navigateTo({url:"../IM/main?userId="+this.currentCompany.userId+"&logo="+this.currentCompany.logo+"&type=2&cardId="+this.currentCompany.cardId+"&name="+this.currentCompany.name+"&wxCode="+(this.currentCompany.personalWx||"")+"&phone="+this.currentCompany.phone})},loginSuccess:function(t){this.isLogin=!0,this.inits(),this.getAd(),this.hasCard=wx.getStorageSync("hasCard")||!1,this.avatarUrl=wx.getStorageSync("avatarUrl")||""},loginFailed:function(){this.isShowLoginGuide=!0},preview:function(t){this.previewImages(this.banners,this.banners[t])},getAd:function(){var t=this;this.getPlateAds(3).then((function(n){t.banners=n?n.map((function(t){return t.photo})):["http://jewshop-one-stand-test.oss-cn-shenzhen.aliyuncs.com/product-index/20190418160834.png"]})).catch((function(){t.banners=["http://jewshop-one-stand-test.oss-cn-shenzhen.aliyuncs.com/product-index/20190418160834.png"]}))},getMoreComment:function(t,n){var e;(e=this.dynamic_lists[n].commentModelList).push.apply(e,p(t)),this.$set(this,"dynamic_lists",JSON.parse(JSON.stringify(this.dynamic_lists)))},getcompany:function(){var t=this,n={},e=t.emojiChar.split("-"),o=[];t.dynamic_lists=[],t.emoji.forEach((function(t,i){n={char:e[i],emoji:"0x1f"+t},o.push(n)})),t.emojis=o,a.default.POST({companyId:t.COMPANYID},"","/goods/getCompanyInfo/V2").then((function(n,e){n&&(t.company_msg={admin_logo:n.companyLogo||"",company_logo:n.companyLogo||"",company_name:n.companyName||""})})).catch((function(n){t.company_msg={}}))},inits:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=this;n.isLoading?wx.hideLoading():(n.isLoading=!0,a.default.POST({companyId:n.COMPANYID,pageNum:n.page,refresh:t,cardId:this.currentCompany.cardId||n.CARDID||0},"","/personal/getDynamicInfo").then((function(t,e){if(wx.hideLoading(),t){new Date;t.forEach((function(t,n){t.photos=t.photos?t.photos.split(","):[],t.createTime=c.default.getdate(t.createTime,"dateTime"),t.doThumbsName=t.doThumbsName?t.doThumbsName.split(","):[]})),n.dynamic_lists=[].concat(p(n.dynamic_lists),p(t)),n.page++,setTimeout((function(){n.isLoading=!1}),500)}})).catch((function(t){console.log(t),wx.hideLoading(),204==t.code&&(n.nodata=!0),setTimeout((function(){n.isLoading=!1}),500)})))},operate_tap:function(t){(0,u.authSubscribeMessage)(this.subscriptionNew);var n=!this.dynamic_lists[t].operate_show;this.$set(this.dynamic_lists[t],"operate_show",n)},addComment:function(n,e){(0,u.authSubscribeMessage)(this.subscriptionNew);var o=s.default.returnIsLogin();if(o){if(!(e.userName&&!e.commentId||e.commentId&&e.userId==wx.getStorageSync("userId"))){this.input_show=!0,this.replayComment=e,this.add_comments_index=n;var i=this;setTimeout((function(){i.$set(i.dynamic_lists[n],"operate_show",!1),i.comment_focus=!0}),200)}}else t.showToast({title:"ËØ∑ÂÖàÁôªÂΩï,ÊâçÂèØ‰ª•ËØÑËÆ∫Âñî",icon:"none"})},smile_tap:function(){this.emoji_show?this.comment_focus=!1:(this.emoji_show=!0,this.comment_focus=!1)},inputgetFocus:function(t,n){},emoji_tap:function(t){this.comments=this.comments+t},emoji_del:function(){console.log("del"),this.comments.substr(0,this.comments.length-1),console.log(this.comments)},tap_all:function(){this.input_show=!1,this.comment_focus=!1;try{this.dynamic_lists[this.add_comments_index]&&this.$set(this.dynamic_lists[this.add_comments_index],"operate_show",!1)}catch(t){console.log("e",t)}},clearPage:function(){console.log("clearpage"),this.input_show=!1,this.comment_focus=!1,this.comments="";try{this.$set(this.dynamic_lists[this.add_comments_index],"operate_show",!1)}catch(t){}},inputConfirm:function(){var t=this;this.emoji_show=!1,this.comment_focus=!1,(0,u.authSubscribeMessage)(this.subscriptionNew),a.default.POST({dynamicId:this.dynamic_lists[this.add_comments_index].dynamicId,parentId:this.replayComment.commentId||0,cardId:this.currentCompany.cardId||this.CARDID||0,text:this.comments},"","/personal/doComment").then((function(n){var e=t.dynamic_lists[t.add_comments_index];e.commentModelList=e.commentModelList?e.commentModelList:[],(e.commentModelList.length<10||e.commentNum>e.commentModelList.length)&&(t.dynamic_lists[t.add_comments_index].commentModelList.push({text:t.comments,replyName:t.replayComment.userName||"",userName:wx.getStorageSync("USERNAME")}),t.$set(t,"dynamic_lists",JSON.parse(JSON.stringify(t.dynamic_lists)))),t.input_show=!1,t.comments=""}))},zan:function(n,e,o){(0,u.authSubscribeMessage)(this.subscriptionNew);var i=s.default.returnIsLogin();if(i){var c=this;wx.showLoading(),a.default.POST({dynamicId:o,cardId:wx.getStorageSync("CARDID")},"","/personal/doDynamicThumbs").then((function(t){wx.hideLoading(),t?(c.dynamic_lists[n].doThumbsName.push(t),c.$set(c.dynamic_lists[n],"isThumbs",1),c.$set(c.dynamic_lists[n],"doThumbsNum",++c.dynamic_lists[n].doThumbsNum)):(c.dynamic_lists[n].doThumbsName.pop(),c.$set(c.dynamic_lists[n],"isThumbs",0),c.$set(c.dynamic_lists[n],"doThumbsNum",--c.dynamic_lists[n].doThumbsNum));var e=!c.dynamic_lists[n].operate_show;c.$set(c.dynamic_lists[n],"operate_show",e)})).catch((function(t){console.log(t),wx.hideLoading()}))}else t.showToast({title:"ËØ∑ÂÖàÁôªÂΩï,ÊâçÂèØ‰ª•ÁÇπËµûÂñî",icon:"none"})}},computed:h({},(0,i.mapState)({currentCompany:function(t){return t.currentCompany}}),{},(0,i.mapGetters)(["subscriptionNew"])),watch:{currentCompany:{deep:!0,immediate:!0,handler:function(t){t&&(t.userId===wx.getStorageSync("userId")?this.isShowTalk=!1:(this.isShowTalk=!0,this.targetAvatarUrl=t.logo))}}},onShareAppMessage:function(t){var n=null;try{n=t.target.dataset.dynamicid}catch(t){}this.addDynamicForwardRecord(this.CARDID,n);var e=this.CARDID+""+(new Date).getTime();(0,r.addShareRecord)(this.COMPANYID,4,this.dynamic_lists[0].dynamicId,e).then((function(t){}),(function(t){}));var o=n?"/pages/dynamicDetail/main?dynamicId=".concat(n,"&companyId=").concat(this.COMPANYID,"&cardId=").concat(this.CARDID,"&goType=1&shareId=").concat(e):"/pages/Dynamic/main?companyId=".concat(this.COMPANYID,"&cardId=").concat(this.CARDID,"&goType=1&shareId=").concat(e);return{title:JSON.parse(wx.getStorageSync("CURRENT_COMPANY")).companyName,path:o,success:function(t){wx.showShareMenu({withShareTicket:!0})},fail:function(t){console.log("Â§±Ë¥•-- ",t)}}}};n.default=A}).call(this,e("543d")["default"])},dcc3:function(t,n,e){"use strict";var o,i=function(){var t=this,n=t.$createElement;t._self._c},s=[];e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return s})),e.d(n,"a",(function(){return o}))}},[["27d6","common/runtime","common/vendor"]]]);